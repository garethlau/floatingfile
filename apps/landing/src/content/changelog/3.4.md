---
date: January 14, 2022
---

Had some time during winter break.

## Yearly Refactor

## Web Updates

Fixes, changes, and additions:

- Fixed a bug where downloaded files on mobile devices would be missing the file extension
- Fixed a bug where users that recently destroyed a space and immediately created a space would be redirected back to the home page
- Fixed a bug where clicking the remove file button on mobile wouldn't do anything
- Increased storage capacity of each space from 1 GB to 5 GB
- Increased the accuracy and range of the file size calculation, previously maxed out at 1 GB
- Changed the download process so that multiple downloads can occur simultaneously (previously, starting one download would prevent the user from downloading other files)
- Removed uncommon animal names from the list of usernames
- Added a new feature where users can cancel individual file downloads
- Added timestamps to the event logs and a more detailed explanation of the event when hovered
- Added a confirmation step when more than 5 files are selected to be uploaded

### File Download Support

In release [v3.1](#v3.1), the decision was made to disable the ability to download files on mobile browsers due to inconsistent support.

> "All browsers now open the requested file in a new tab. To visually reflect this change, using the mobile version of floatingfile will show different buttons indicating the functionality (download or open)."<br><br> -[v3.1 Release Note](#v3.1)

A comprehensive list is now being generated for each device and browser so you can expect, beforehand, which browsers will enable the best experience. Notice something wrong? Don't see your OS or browser? Please submit [a ticket](https://github.com/garethlau/floatingfile/issues) or message me.
Here are the results as of v3.4:

|   OS    | Browser | Supported? |
| :-----: | :-----: | :--------: |
|  macOS  | Safari  |    Yes     |
|  macOS  | Chrome  |    Yes     |
|  macOS  |  Brave  |    Yes     |
|  macOS  | Firefox |    Yes     |
|  macOS  |  Edge   |    Yes     |
| Windows | Safari  |    Yes     |
| Windows | Chrome  |    Yes     |
| Windows |  Brave  |    Yes     |
| Windows | Firefox |    Yes     |
| Windows |  Edge   |    Yes     |
|   iOS   | Safari  |    Yes     |
|   iOS   | Chrome  |     No     |
|   iOS   |  Brave  |     No     |
|   iOS   | Firefox |     No     |
|   iOS   |  Edge   |     No     |
| Android | Chrome  |    Yes     |
| Android |  Brave  |    Yes     |
| Android | Firefox |    Yes     |
| Android |  Edge   |    Yes     |

In summary:

- If you are using a mac, any browser will work fine
- If you are using a windows computer, any browser will work
- If you are using an iPhone, use Safari
- If you use a phone that runs Android, use Google Chrome

## iOS Updates

// TODO ...

## Introducing the floatingfile CLI

You can now interact with floatingfile through the official floatingfile command line interface. For more installation instructions and usage guides, visit the [docs](https://floatingfile.space/cli).

### Technical Notes

This release actually reflects a significant refactor of the server. A goal I've had for a while now was to achieve end-to-end type safety which this release accomplishes. To achieve this goal, I switched the database from mongo to postgres. This was motivated by Prisma's (a TypeScript ORM) first class TypeScript support which is in stark contrast to the hacks to get mongoose working with TypeScript.

To share method signatures, both the client and server now depend on a third package that defines the "contracts". Method signatures are implemented by the server which allows the client to safely consume the exposed methods. I moved away from REST and instead implemented a RPC pattern where every request (queries and mutations) are all `POST` requests to `/api/rpc` with a body containing an endpoint string and a payload object. If you've worked with graphql, it's very similar just much simpler.

In the process of this refactor, I also refactored the file upload and download endpoints to improve the consistency.
